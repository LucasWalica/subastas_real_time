<div class="min-h-screen bg-gray-50">
  
  <!-- HEADER -->
  <header class="bg-white shadow-sm border-b p-4">
    <button 
      (click)="onBack()"
      class="flex items-center gap-2 text-gray-600 hover:text-gray-900">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
      </svg>
      Volver
    </button>
  </header>

  <main class="max-w-7xl mx-auto px-4 py-8 sm:px-6 lg:px-8">

    <!-- ESTADO LIVE -->
    <div class="flex items-center justify-between mb-6">
      <div class="flex items-center gap-3">
        <div class="w-3 h-3 bg-red-500 rounded-full animate-pulse"></div>
        <span class="text-red-600">EN VIVO</span>

        <!-- VISIBILIDAD SOLO ADMIN -->
        <span *ngIf="isAdmin" class="inline-flex items-center gap-1 bg-pink-600 text-white px-3 py-1 rounded-md">
          ğŸ‘‘ Administrador
        </span>
      </div>
      <div class="flex items-center gap-2 text-gray-600">
        ğŸ‘¥
        <span>{{connectedUsers}} usuarios conectados</span>
      </div>
    </div>

    <h1 class="text-xl font-semibold">Subasta de Arte ContemporÃ¡neo</h1>

    <div class="grid lg:grid-cols-3 gap-6 mt-6">

      <!-- ÃTEM ACTUAL -->
      <div class="lg:col-span-2 space-y-6">
        <div class="bg-white rounded-lg shadow p-6">

          <div class="bg-gray-100 aspect-video rounded-lg mb-4 flex items-center justify-center">
            <span class="text-gray-400">[Imagen del item actual]</span>
          </div>

          <div class="flex items-center justify-between">
            <h2 class="font-semibold text-lg">{{currentItem.name}}</h2>
            <span class="text-gray-600 text-sm">Item {{currentItemIndex + 1}} / {{items.length}}</span>
          </div>

          <p class="text-gray-600 mb-6">{{currentItem.description}}</p>

          <div class="bg-accent/10 border-2 border-accent rounded-lg p-6 mb-6">
            <div class="flex items-center justify-between">
              <div>
                <p class="text-gray-600 text-sm mb-1">Puja Actual</p>
                <p class="text-accent font-bold text-lg">
                  ${{currentItem.currentBid | number}}
                </p>
              </div>
              <div class="text-gray-600 flex items-center gap-1">
                ğŸ“ˆ <span>{{currentItem?.bids}} pujas</span>
              </div>
            </div>
          </div>

          <!-- ACCIONES USUARIO -->
          <div *ngIf="!isAdmin" class="flex gap-4">
            <input type="number"
                   [(ngModel)]="bidAmount"
                   class="flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-primary"
                   [placeholder]="'MÃ­nimo: $' + (currentItem.currentBid + 100)">
            <button (click)="placeBid()"
              class="bg-accent text-white px-8 py-3 rounded-lg flex items-center gap-2">
              ğŸ”¨ Pujar
            </button>
          </div>

          <!-- ACCIONES ADMIN -->
          <div *ngIf="isAdmin" class="space-y-3">
            <button (click)="awardItem()"
                    class="w-full bg-accent text-white px-4 py-3 rounded-lg">
              ğŸ Adjudicar Item
            </button>
            <button (click)="nextItem()"
                    class="w-full bg-primary text-white px-4 py-3 rounded-lg"
                    [disabled]="currentItemIndex >= items.length - 1">
              â¡ï¸ Siguiente Item
            </button>
            <button class="w-full border border-gray-300 px-4 py-2 rounded-lg">
              â¸ Pausar Subasta
            </button>
            <button class="w-full border border-red-500 text-red-500 px-4 py-2 rounded-lg">
              âŒ Finalizar Subasta
            </button>
          </div>

        </div>

        <!-- PRÃ“XIMOS ITEMS -->
        <div class="bg-white rounded-lg shadow p-6">
          <h3 class="mb-4 font-medium">PrÃ³ximos Items</h3>
          <div class="grid grid-cols-3 gap-4">
            <div *ngFor="let item of items.slice(currentItemIndex + 1)"
                class="border rounded-lg p-3">
              <div class="bg-gray-100 aspect-square rounded mb-2"></div>
              <p class="text-sm truncate">{{item.name}}</p>
              <p class="text-xs text-gray-500">${{item.currentBid}}</p>
            </div>

            <p *ngIf="items.slice(currentItemIndex+1).length===0"
              class="text-gray-500 col-span-3 text-center">
              No hay mÃ¡s items
            </p>
          </div>
        </div>

      </div>

      <!-- SIDEBAR: CHAT + HISTORIAL -->
      <div class="space-y-6">

        <!-- HISTORIAL DE PUJAS -->
        <div class="bg-white rounded-lg shadow p-6">
          <h3 class="mb-4 font-medium">ğŸ“Š Historial de Pujas</h3>

          <div class="space-y-2 max-h-64 overflow-y-auto">
            <div *ngFor="let bid of bidHistory"
                 class="border-l-4 border-accent pl-3 py-2 bg-accent/5 rounded-r">
              <div class="flex justify-between">
                <span>{{bid.user}}</span>
                <span class="text-xs text-gray-500">{{bid.time}}</span>
              </div>
              <p class="text-primary font-semibold">${{bid.amount}}</p>
            </div>
          </div>
        </div>

        <!-- CHAT EN VIVO -->
        <div class="bg-white rounded-lg shadow p-6">
          <h3 class="mb-4 font-medium">ğŸ’¬ Chat en Vivo</h3>

          <div class="space-y-2 max-h-80 overflow-y-auto mb-4 pb-2">
            <ng-container *ngFor="let msg of chatMessages">
              
              <!-- MENSAJE DE PUJA -->
              <div *ngIf="msg.type==='bid'" 
                   class="bg-accent/10 border border-accent rounded-lg p-2">
                ğŸ”¨ <b>{{msg.user}}</b> pujÃ³ 
                <span class="text-accent">${{msg.amount}}</span>
                <div class="text-xs text-gray-500">{{msg.time}}</div>
              </div>

              <!-- MENSAJE NORMAL -->
              <div *ngIf="msg.type==='message'" class="text-sm">
                <b class="text-primary">{{msg.user}}:</b>
                {{msg.message}}
                <div class="text-xs text-gray-500">{{msg.time}}</div>
              </div>

            </ng-container>
          </div>

          <!-- INPUT CHAT -->
          <div class="flex gap-2">
            <input type="text"
                   [(ngModel)]="chatMessage"
                   (keyup.enter)="sendMessage()"
                   placeholder="Escribe un mensaje..."
                   class="flex-1 px-3 py-2 border border-gray-300 rounded-lg">
            <button class="bg-primary text-white p-2 rounded-lg"
                    (click)="sendMessage()">ğŸ“©</button>
          </div>
        </div>

      </div>

    </div>
  </main>

</div>
